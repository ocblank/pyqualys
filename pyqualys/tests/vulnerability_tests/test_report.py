# -*- coding: utf-8 -*-
import unittest
import pyqualys
from pyqualys.utils import util


class TestReport(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        cls.__instance = pyqualys.QualysAPI(username="abc",
                                            password="abc",
                                            host="https://qualys.com/")
        cls.__service = cls.__instance.service("vulnerability")

    def test_01_list_report(self):
        data = {
            'action': 'list'
        }
        report_list = self.__service.report.list_report(**data)
        self.assertEqual(200, report_list['status'])

    def test_02_scan_report(self):
        data = {
            'report_title': 'pyqualys report',
            'action': 'launch',
            'report_type': 'Scan',
            'template_id': '134271',
            'output_format': 'pdf',
        }
        scan_report = self.__service.report.scan_report(**data)
        self.assertEqual(200, scan_report['status'])
