# -*- coding: utf-8 -*-
import logging
from ...utils import util
from ..report import ReportFormat

logger = logging.getLogger(__name__)


class Reports(object):

    def __init__(self, session, api_version, urls_map):
        self.session = session
        self.asset_api_version = api_version
        self.urls_map = urls_map
        super(Reports, self).__init__(session=session,
                                      api_version=api_version,
                                      urls_map=urls_map)

    @ReportFormat(data.get('format', None))
    def __get_obj(self, **data):

        uri = self.asset_api_version + self.urls_map.report
        resp = self.session.post(uri, data)
        response = resp.text
        return {"response": response,
                "status": resp.status_code
                }

    def scan_report(self, **kwargs):
        kwargs["action"] = "launch"
        return self.__get_obj(**kwargs)
